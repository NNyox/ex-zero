<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300..700&display=swap" rel="stylesheet">
  <title>Equis-Cero</title>
  <style>
    *{
      user-select: none;
      font-family: 'Franklin Gothic';
      /* transition: all ease-out 0.5s; */
    }
    #table {
      position: absolute;
      transform: translate(-50%, -50%);
      left: 50%;
      top: 50%;
      width: 75vw;
      max-width: 350px;
      aspect-ratio: 1 / 1;
      display: grid;
      grid-template-rows: repeat(3, 1fr);
      grid-template-columns: repeat(3, 1fr);
    }
    .tableAnimation {
      animation: 0.7s tableDisapear;
      animation-fill-mode: forwards;
      pointer-events: none;
    }
    @keyframes tableDisapear {
      from {}
      to {
        opacity: 0.3;
        width: 80vw;
      }
    }
    .face {
      height: 100%;
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }
      #face1, #face3, #face4, #face6 {
        border-bottom: 2px solid black;
      }
      #face2, #face5 {
        border-bottom: 2px solid black;
        border-left: 2px solid black;
        border-right: 2px solid black;
      }
      #face8 {
        border-left: 2px solid black;
        border-right: 2px solid black;
      }
      .figure {
        font-family: 'Fredoka', sans-serif;
        position: absolute;
        opacity: 0;
        font-size: clamp(10px, 75px, 15vw);
      }
        #equis {
          color: red;
        }
        #cero {
          color: blue;
        }
    #button {
      font-size: clamp(10px, 40px, 10vw);
      position: absolute;
      transform: translate(-50%, -50%);
      left: 50%;
      bottom: 1%;
      border: none;
      background: none;
    }
    #text {
      font-size: clamp(10px, 50px, 10vw);
      position: absolute;
      transform: translate(-50%, -50%);
      left: 50%;
      top: 10%;
    }
    .textAnimation {
      animation: 0.7s winMove;
      animation-fill-mode: forwards;
    }
    @keyframes winMove {
      from {}
      to {
        font-size: clamp(10px, 60px, 12vw);
      }
    }
  </style>
</head>

<body>
  <div id="table">
    <div class="face" id="face1">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
    <div class="face" id="face2">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
    <div class="face" id="face3">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
    <div class="face" id="face4">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
    <div class="face" id="face5">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
    <div class="face" id="face6">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
    <div class="face" id="face7">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
    <div class="face" id="face8">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
    <div class="face" id="face9">
      <span class="figure" id="equis">x</span>
      <span class="figure" id="cero">o</span>
    </div>
  </div>
  <a href="index copy.html">
    <button id="button">reiniciar</button>
  </a>
  <a id="link" href=""></a>
  <span id="text" style="color: red;">turno de X</span>

  <script>
    let turnoX = true;
    let winDetected = false;
    let draw = 1;
    const text = document.getElementById("text");
    const table = document.getElementById("table");

    document.querySelectorAll(".face").forEach(element => {
      function write() {
        turnoX ? (
          element.querySelector("#equis").style.opacity = "1"
        ) : (
          element.querySelector("#cero").style.opacity = "1"
        );
        verifyWin();
        if (!winDetected) {
          turnoX ? (
            text.textContent = "turno de O",
            text.style.color = "blue"
          ) : (
            text.textContent = "turno de X",
            text.style.color = "red"
          );
        };
        turnoX = !turnoX;
        if (draw < 9) {
          draw++;
        } else {
          table.setAttribute("class", "tableAnimation");
          text.setAttribute("class", "textAnimation");
          text.textContent = "Empate";
          text.style.color = "black";
        };
        element.removeEventListener("click", write);
      };
      element.addEventListener("click", write)
    });

    function verifyWin() {
      console.clear();
      let winObj = turnoX ? "#equis" : "#cero";
      function Winner() {
        table.setAttribute("class", "tableAnimation");
        text.setAttribute("class", "textAnimation");
        text.textContent = `gana ${turnoX ? "X" : "O"}`;
        text.style.color = turnoX ? "red" : "blue";
        winDetected = true;
      };
      function detectCells(x, y, z) {
        console.log(
          x,
          getComputedStyle(document.getElementById(x).querySelector(winObj)).opacity,
          y,
          getComputedStyle(document.getElementById(y).querySelector(winObj)).opacity,
          z,
          getComputedStyle(document.getElementById(z).querySelector(winObj)).opacity
        );
          if (
            getComputedStyle(document.getElementById(x).querySelector(winObj)).opacity === "1" &&
              getComputedStyle(document.getElementById(y).querySelector(winObj)).opacity === "1" &&
              getComputedStyle(document.getElementById(z).querySelector(winObj)).opacity === "1"
            ) {
            Winner();
          };
        };
      const winningCombinations = [[1, 2, 3],[1, 5, 9],[1, 4, 7],[2, 5, 8],[3, 5, 7],[3, 6, 9],[4, 5, 6],[7, 8, 9]];
      for (let i in winningCombinations) {
        let combination = winningCombinations[i];
        detectCells(`face${combination[0]}`, `face${combination[1]}`, `face${combination[2]}`);
      };
    };
  </script>
</body>

</html>